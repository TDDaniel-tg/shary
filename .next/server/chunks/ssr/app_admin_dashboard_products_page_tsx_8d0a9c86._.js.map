{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Desktop/work/project/app/admin_dashboard/products/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport Link from 'next/link';\r\nimport { ArrowLeft, Plus, Search, Edit, Trash2, Eye } from 'lucide-react';\r\nimport Image from 'next/image';\r\n\r\ninterface Product {\r\n  id: number;\r\n  name: string;\r\n  price: number;\r\n  image_url?: string;\r\n  stock_quantity: number;\r\n  is_featured: boolean;\r\n  is_active: boolean;\r\n  created_at: string;\r\n}\r\n\r\nexport default function ProductsManagementPage() {\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [deleteLoading, setDeleteLoading] = useState<number | null>(null);\r\n  const router = useRouter();\r\n\r\n  // Мок данные для демонстрации\r\n  const mockProducts: Product[] = [\r\n    {\r\n      id: 1,\r\n      name: 'Воздушные шары латексные \"Радуга\"',\r\n      price: 250,\r\n      image_url: '/images/products/balloon.png',\r\n      stock_quantity: 150,\r\n      is_featured: true,\r\n      is_active: true,\r\n      created_at: '2024-01-15'\r\n    },\r\n    {\r\n      id: 2,\r\n      name: 'Фольгированные шары \"Звезда\"',\r\n      price: 450,\r\n      image_url: '/images/products/balloon.png',\r\n      stock_quantity: 85,\r\n      is_featured: false,\r\n      is_active: true,\r\n      created_at: '2024-01-14'\r\n    },\r\n    {\r\n      id: 3,\r\n      name: 'Шары для моделирования ШДМ',\r\n      price: 199,\r\n      image_url: '/images/products/balloon.png',\r\n      stock_quantity: 0,\r\n      is_featured: false,\r\n      is_active: false,\r\n      created_at: '2024-01-13'\r\n    }\r\n  ];\r\n\r\n  useEffect(() => {\r\n    fetchProducts();\r\n  }, []);\r\n\r\n  const fetchProducts = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const token = localStorage.getItem('admin-token');\r\n      if (!token) {\r\n        router.push('/admin/login');\r\n        return;\r\n      }\r\n\r\n      const response = await fetch('/api/admin/products', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setProducts(data.data || []);\r\n      } else {\r\n        console.log('API недоступно, используем мок данные');\r\n        setProducts(mockProducts);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching products:', error);\r\n      setProducts(mockProducts);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (productId: number) => {\r\n    if (!confirm('Вы уверены, что хотите удалить этот товар?')) return;\r\n\r\n    setDeleteLoading(productId);\r\n    try {\r\n      const token = localStorage.getItem('admin-token');\r\n      const response = await fetch(`/api/admin/products/${productId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        alert('Товар успешно удален!');\r\n        fetchProducts();\r\n      } else {\r\n        alert('Ошибка при удалении товара');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting product:', error);\r\n      alert('Произошла ошибка при удалении товара');\r\n    } finally {\r\n      setDeleteLoading(null);\r\n    }\r\n  };\r\n\r\n  const filteredProducts = products.filter(product =>\r\n    product.name.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString('ru-RU');\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-100 flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-pink-500\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100\">\r\n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <Link\r\n            href=\"/admin_dashboard\"\r\n            className=\"inline-flex items-center text-gray-600 hover:text-gray-900 mb-4\"\r\n          >\r\n            <ArrowLeft className=\"h-5 w-5 mr-2\" />\r\n            Назад к панели управления\r\n          </Link>\r\n          \r\n          <div className=\"flex justify-between items-center\">\r\n            <h1 className=\"text-3xl font-bold text-gray-900\">Управление товарами</h1>\r\n            <Link\r\n              href=\"/admin_dashboard/products/add\"\r\n              className=\"bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600 transition-colors flex items-center gap-2\"\r\n            >\r\n              <Plus className=\"h-5 w-5\" />\r\n              Добавить товар\r\n            </Link>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Search */}\r\n        <div className=\"mb-6\">\r\n          <div className=\"relative max-w-md\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Поиск товаров...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-pink-500\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Products List */}\r\n        <div className=\"bg-white rounded-lg shadow-sm overflow-hidden\">\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"min-w-full divide-y divide-gray-200\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Товар\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Цена\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Склад\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Статус\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Дата создания\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Действия\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                {filteredProducts.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan={6} className=\"px-6 py-12 text-center text-gray-500\">\r\n                      {searchTerm ? 'Товары не найдены' : 'Нет товаров для отображения'}\r\n                    </td>\r\n                  </tr>\r\n                ) : (\r\n                  filteredProducts.map((product) => (\r\n                    <tr key={product.id} className=\"hover:bg-gray-50\">\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"flex items-center\">\r\n                          <div className=\"flex-shrink-0 h-16 w-16\">\r\n                            <Image\r\n                              src={product.image_url || '/images/products/balloon.png'}\r\n                              alt={product.name}\r\n                              width={64}\r\n                              height={64}\r\n                              className=\"rounded-lg object-cover\"\r\n                            />\r\n                          </div>\r\n                          <div className=\"ml-4\">\r\n                            <div className=\"text-sm font-medium text-gray-900 max-w-xs truncate\">\r\n                              {product.name}\r\n                            </div>\r\n                            {product.is_featured && (\r\n                              <div className=\"text-xs text-pink-600 bg-pink-100 px-2 py-1 rounded mt-1 inline-block\">\r\n                                Рекомендуемый\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm font-medium text-gray-900\">\r\n                          {product.price} ₽\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className={`text-sm ${\r\n                          product.stock_quantity > 0 ? 'text-green-600' : 'text-red-600'\r\n                        }`}>\r\n                          {product.stock_quantity} шт.\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\r\n                          product.is_active\r\n                            ? 'bg-green-100 text-green-800'\r\n                            : 'bg-red-100 text-red-800'\r\n                        }`}>\r\n                          {product.is_active ? 'Активен' : 'Неактивен'}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                        {formatDate(product.created_at)}\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\r\n                        <div className=\"flex items-center justify-end gap-2\">\r\n                          <Link\r\n                            href={`/products/${product.id}`}\r\n                            className=\"text-blue-600 hover:text-blue-900 p-1\"\r\n                            title=\"Просмотреть\"\r\n                          >\r\n                            <Eye className=\"h-4 w-4\" />\r\n                          </Link>\r\n                          <Link\r\n                            href={`/admin_dashboard/products/edit/${product.id}`}\r\n                            className=\"text-green-600 hover:text-green-900 p-1\"\r\n                            title=\"Редактировать\"\r\n                          >\r\n                            <Edit className=\"h-4 w-4\" />\r\n                          </Link>\r\n                          <button\r\n                            onClick={() => handleDelete(product.id)}\r\n                            disabled={deleteLoading === product.id}\r\n                            className=\"text-red-600 hover:text-red-900 p-1 disabled:opacity-50\"\r\n                            title=\"Удалить\"\r\n                          >\r\n                            <Trash2 className=\"h-4 w-4\" />\r\n                          </button>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Stats */}\r\n        <div className=\"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <div className=\"bg-white p-4 rounded-lg shadow-sm\">\r\n            <div className=\"text-sm text-gray-600\">Всего товаров</div>\r\n            <div className=\"text-2xl font-bold text-gray-900\">{products.length}</div>\r\n          </div>\r\n          <div className=\"bg-white p-4 rounded-lg shadow-sm\">\r\n            <div className=\"text-sm text-gray-600\">Активных товаров</div>\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              {products.filter(p => p.is_active).length}\r\n            </div>\r\n          </div>\r\n          <div className=\"bg-white p-4 rounded-lg shadow-sm\">\r\n            <div className=\"text-sm text-gray-600\">Заканчивающихся товаров</div>\r\n            <div className=\"text-2xl font-bold text-red-600\">\r\n              {products.filter(p => p.stock_quantity < 10).length}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":"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","debugId":null}}]
}