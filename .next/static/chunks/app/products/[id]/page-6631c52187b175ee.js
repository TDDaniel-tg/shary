(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3403],{333:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("thumbs-up",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]])},1007:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},1366:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]])},4616:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4761:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(5155),i=s(2115),r=s(8564),l=s(1366),n=s(1007),c=s(333);function d(e){let{productId:t}=e,[s,d]=(0,i.useState)([]),[o,m]=(0,i.useState)(!0),[u,p]=(0,i.useState)(!1),[x,h]=(0,i.useState)({rating:5,comment:"",userName:""}),[g,y]=(0,i.useState)(!1),f=[{id:1,userId:1,userName:"Анна К.",rating:5,comment:"Отличные воздушные шары! Качество превосходное, яркие цвета. Дети были в восторге на празднике!",date:"2024-01-15",helpful:12,isModerated:!0},{id:2,userId:2,userName:"Михаил П.",rating:4,comment:"Хорошие шары, быстрая доставка. Один шар лопнул через день, но в целом качество нормальное.",date:"2024-01-10",helpful:8,isModerated:!0},{id:3,userId:3,userName:"Елена С.",rating:5,comment:"Заказывала для свадьбы - все гости были в восторге! Шары держали форму весь день.",date:"2024-01-05",helpful:15,isModerated:!0}];(0,i.useEffect)(()=>{N()},[t]);let N=async()=>{m(!0);try{let e=await fetch("/api/products/".concat(t,"/reviews"));if(e.ok){let t=await e.json();d(t.reviews||[])}else d(f)}catch(e){d(f)}finally{m(!1)}},v=async e=>{if(e.preventDefault(),x.comment.trim()&&x.userName.trim()){y(!0);try{if((await fetch("/api/products/".concat(t,"/reviews"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...x,productId:t})})).ok){let e={id:Date.now(),userId:0,userName:x.userName,rating:x.rating,comment:x.comment,date:new Date().toISOString().split("T")[0],helpful:0,isModerated:!1};d(t=>[e,...t]),h({rating:5,comment:"",userName:""}),p(!1),alert("Спасибо! Ваш отзыв отправлен на модерацию.")}else alert("Произошла ошибка при отправке отзыва")}catch(e){alert("Произошла ошибка при отправке отзыва")}finally{y(!1)}}},b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sm",s="lg"===t?"h-6 w-6":"h-4 w-4";return(0,a.jsx)("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(t=>(0,a.jsx)(r.A,{className:"".concat(s," ").concat(t<=e?"text-yellow-400 fill-current":"text-gray-300")},t))})},j=s.length>0?s.reduce((e,t)=>e+t.rating,0)/s.length:0;return o?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Отзывы"}),(0,a.jsx)("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"bg-gray-100 h-24 rounded-lg"},e))})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold",children:["Отзывы (",s.length,")"]}),s.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[b(Math.round(j)),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[j.toFixed(1)," из 5"]})]})]}),(0,a.jsxs)("button",{onClick:()=>p(!u),className:"bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600 transition-colors flex items-center gap-2",children:[(0,a.jsx)(l.A,{className:"h-4 w-4"}),"Оставить отзыв"]})]}),u&&(0,a.jsxs)("form",{onSubmit:v,className:"bg-gray-50 p-6 rounded-lg space-y-4",children:[(0,a.jsx)("h4",{className:"font-semibold",children:"Добавить отзыв"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ваше имя"}),(0,a.jsx)("input",{type:"text",value:x.userName,onChange:e=>h(t=>({...t,userName:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Оценка"}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>h(t=>({...t,rating:e})),className:"p-1",children:(0,a.jsx)(r.A,{className:"h-6 w-6 ".concat(e<=x.rating?"text-yellow-400 fill-current":"text-gray-300 hover:text-yellow-200")})},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Комментарий"}),(0,a.jsx)("textarea",{value:x.comment,onChange:e=>h(t=>({...t,comment:e.target.value})),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500",placeholder:"Поделитесь своим мнением о товаре...",required:!0})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"submit",disabled:g,className:"bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600 disabled:opacity-50 transition-colors",children:g?"Отправка...":"Отправить отзыв"}),(0,a.jsx)("button",{type:"button",onClick:()=>p(!1),className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Отмена"})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===s.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Пока нет отзывов. Будьте первым!"}):s.map(e=>(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[!e.isModerated&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 px-3 py-1 rounded text-sm mb-3",children:"Отзыв ожидает модерации"}),(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:(0,a.jsx)(n.A,{className:"h-5 w-5 text-gray-500"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:e.userName}),b(e.rating),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.date})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-3",children:e.comment}),(0,a.jsx)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:(0,a.jsxs)("button",{className:"flex items-center gap-1 hover:text-pink-600 transition-colors",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"Полезно (",e.helpful,")"]})})]})]})]},e.id))})]})}},5099:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(5155),i=s(2115),r=s(7809),l=s(7712),n=s(4616),c=s(7606);function d(e){let{product:t}=e,[s,d]=(0,i.useState)(1),[o,m]=(0,i.useState)(!1),{addItem:u}=(0,c._)(),p=async()=>{if(t.inStock){m(!0);try{for(let e=0;e<s;e++)u({id:t.id,name:t.name,price:t.price,image:t.image});alert("".concat(t.name," добавлен в корзину!"))}catch(e){alert("Произошла ошибка при добавлении товара в корзину")}finally{m(!1)}}};return t.inStock?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Количество:"}),(0,a.jsxs)("div",{className:"flex items-center border border-gray-300 rounded-lg",children:[(0,a.jsx)("button",{onClick:()=>{d(e=>Math.max(e-1,1))},className:"p-2 hover:bg-gray-100 transition-colors",disabled:s<=1,children:(0,a.jsx)(l.A,{className:"h-4 w-4"})}),(0,a.jsx)("span",{className:"px-4 py-2 min-w-[3rem] text-center",children:s}),(0,a.jsx)("button",{onClick:()=>{d(e=>Math.min(e+1,10))},className:"p-2 hover:bg-gray-100 transition-colors",disabled:s>=10,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("button",{onClick:p,disabled:o,className:"w-full bg-pink-500 text-white py-4 px-6 rounded-lg font-semibold hover:bg-pink-600 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:[(0,a.jsx)(r.A,{className:"h-5 w-5"}),o?"Добавление...":"Добавить в корзину"]})]}):(0,a.jsxs)("button",{disabled:!0,className:"w-full bg-gray-300 text-gray-500 py-4 px-6 rounded-lg font-semibold cursor-not-allowed flex items-center justify-center gap-2",children:[(0,a.jsx)(r.A,{className:"h-5 w-5"}),"Нет в наличии"]})}},5395:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var a=s(5155),i=s(2115),r=s(6874),l=s.n(r),n=s(6766),c=s(8564);let d=(0,s(9946).A)("heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);function o(e){let{productId:t,categoryId:s}=e,[r,o]=(0,i.useState)([]),[m,u]=(0,i.useState)(!0),p=[{id:2,name:'Воздушные шары "Сердце" красные',price:299,image:"/images/products/balloon.png",rating:4.8,reviews:24,discount:15},{id:3,name:'Фольгированные шары "Звезда"',price:450,image:"/images/products/balloon.png",rating:4.9,reviews:18},{id:4,name:"Шары для моделирования ШДМ",price:199,image:"/images/products/balloon.png",rating:4.7,reviews:31},{id:5,name:"Светящиеся LED шары",price:799,image:"/images/products/balloon.png",rating:4.6,reviews:12,discount:20},{id:6,name:"Шары металлик золото",price:349,image:"/images/products/balloon.png",rating:4.8,reviews:27},{id:7,name:"Конфетти шары прозрачные",price:599,image:"/images/products/balloon.png",rating:4.9,reviews:15}];(0,i.useEffect)(()=>{x()},[t,s]);let x=async()=>{u(!0);try{let e=await fetch("/api/products/related?productId=".concat(t,"&categoryId=").concat(s||""));if(e.ok){let t=await e.json();o(t.products||[])}else{let e=p.filter(e=>e.id!==t);o(e.slice(0,4))}}catch(e){o(p.filter(e=>e.id!==t).slice(0,4))}finally{u(!1)}},h=e=>(0,a.jsx)("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(t=>(0,a.jsx)(c.A,{className:"h-4 w-4 ".concat(t<=e?"text-yellow-400 fill-current":"text-gray-300")},t))});return m?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Похожие товары"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"bg-gray-200 aspect-square rounded-lg mb-3"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"bg-gray-200 h-4 rounded"}),(0,a.jsx)("div",{className:"bg-gray-200 h-4 w-2/3 rounded"})]})]},e))})]}):0===r.length?null:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Похожие товары"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:r.map(e=>(0,a.jsx)("div",{className:"group cursor-pointer",children:(0,a.jsxs)(l(),{href:"/products/".concat(e.id),children:[(0,a.jsxs)("div",{className:"relative bg-gray-100 rounded-lg overflow-hidden aspect-square mb-3",children:[e.discount&&(0,a.jsxs)("div",{className:"absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded text-xs font-semibold z-10",children:["-",e.discount,"%"]}),(0,a.jsx)("button",{className:"absolute top-2 right-2 p-2 bg-white rounded-full shadow-md opacity-0 group-hover:opacity-100 transition-opacity z-10 hover:bg-pink-50",onClick:e=>{e.preventDefault()},children:(0,a.jsx)(d,{className:"h-4 w-4 text-gray-600 hover:text-pink-500"})}),(0,a.jsx)(n.default,{src:e.image,alt:e.name,fill:!0,className:"object-cover group-hover:scale-105 transition-transform duration-300"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 group-hover:text-pink-600 transition-colors line-clamp-2",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[h(e.rating),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["(",e.reviews,")"]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:e.discount?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"text-lg font-semibold text-pink-600",children:[Math.round(e.price*(1-e.discount/100))," ₽"]}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 line-through",children:[e.price," ₽"]})]}):(0,a.jsxs)("span",{className:"text-lg font-semibold text-gray-900",children:[e.price," ₽"]})})]})]})},e.id))}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(l(),{href:"/catalog",className:"inline-flex items-center px-6 py-3 border border-pink-500 text-pink-500 rounded-lg hover:bg-pink-500 hover:text-white transition-colors",children:"Посмотреть все товары"})})]})}},7606:(e,t,s)=>{"use strict";s.d(t,{CartProvider:()=>n,_:()=>c});var a=s(5155),i=s(2115);let r=(e,t)=>{switch(t.type){case"ADD_ITEM":{let s,a=(s=e.items.find(e=>e.id===t.payload.id)?e.items.map(e=>e.id===t.payload.id?{...e,quantity:e.quantity+(t.payload.quantity||1)}:e):[...e.items,{...t.payload,quantity:t.payload.quantity||1}]).reduce((e,t)=>e+t.price*t.quantity,0);return{...e,items:s,total:a}}case"REMOVE_ITEM":{let s=e.items.filter(e=>e.id!==t.payload),a=s.reduce((e,t)=>e+t.price*t.quantity,0);return{...e,items:s,total:a}}case"UPDATE_QUANTITY":{let s=e.items.map(e=>e.id===t.payload.id?{...e,quantity:Math.max(0,t.payload.quantity)}:e).filter(e=>e.quantity>0),a=s.reduce((e,t)=>e+t.price*t.quantity,0);return{...e,items:s,total:a}}case"CLEAR_CART":return{...e,items:[],total:0};case"LOAD_CART":{let s=t.payload.reduce((e,t)=>e+t.price*t.quantity,0);return{...e,items:t.payload,total:s}}case"SET_LOADING":return{...e,isLoading:t.payload};default:return e}},l=(0,i.createContext)(void 0);function n(e){let{children:t}=e,[s,n]=(0,i.useReducer)(r,{items:[],total:0,isLoading:!0});return(0,i.useEffect)(()=>{try{let e=localStorage.getItem("cart");if(e){let t=JSON.parse(e);n({type:"LOAD_CART",payload:t})}}catch(e){}finally{n({type:"SET_LOADING",payload:!1})}},[]),(0,i.useEffect)(()=>{if(!s.isLoading)try{localStorage.setItem("cart",JSON.stringify(s.items))}catch(e){}},[s.items,s.isLoading]),(0,a.jsx)(l.Provider,{value:{state:s,dispatch:n,addItem:e=>{n({type:"ADD_ITEM",payload:e})},removeItem:e=>{n({type:"REMOVE_ITEM",payload:e})},updateQuantity:(e,t)=>{n({type:"UPDATE_QUANTITY",payload:{id:e,quantity:t}})},clearCart:()=>{n({type:"CLEAR_CART"})},getItemQuantity:e=>{let t=s.items.find(t=>t.id===e);return t?t.quantity:0}},children:t})}function c(){let e=(0,i.useContext)(l);if(void 0===e)throw Error("useCart must be used within a CartProvider");return{items:e.state.items,total:e.state.total,isLoading:e.state.isLoading,addItem:e.addItem,removeItem:e.removeItem,updateQuantity:e.updateQuantity,clearCart:e.clearCart,getItemQuantity:e.getItemQuantity,itemCount:e.state.items.reduce((e,t)=>e+t.quantity,0)}}},7712:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},7809:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},8564:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},9834:(e,t,s)=>{Promise.resolve().then(s.bind(s,5099)),Promise.resolve().then(s.bind(s,4761)),Promise.resolve().then(s.bind(s,5395)),Promise.resolve().then(s.t.bind(s,6874,23)),Promise.resolve().then(s.t.bind(s,3063,23))}},e=>{var t=t=>e(e.s=t);e.O(0,[95,6766,8441,1684,7358],()=>t(9834)),_N_E=e.O()}]);