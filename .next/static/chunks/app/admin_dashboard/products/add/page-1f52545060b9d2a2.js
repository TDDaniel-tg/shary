(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4622],{4416:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5695:(e,s,t)=>{"use strict";var a=t(8999);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},7550:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8467:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var a=t(5155),r=t(2115),n=t(5695),l=t(6874),i=t.n(l),c=t(7550),o=t(4416),d=t(9869),m=t(6766);let u={name:"",slug:"",description:"",short_description:"",price:"",original_price:"",category_id:"",stock_quantity:"",sku:"",meta_title:"",meta_description:"",is_featured:!1,tags:[]};function x(){let[e,s]=(0,r.useState)(u),[t,l]=(0,r.useState)([]),[x,p]=(0,r.useState)(!1),[g,h]=(0,r.useState)(null),[b,f]=(0,r.useState)(""),[y,j]=(0,r.useState)(""),[N,k]=(0,r.useState)({}),v=(0,n.useRouter)();(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/categories");if(e.ok){let s=await e.json();l(s.data||[])}}catch(e){l([{id:1,name:"Воздушные шары",slug:"balloons"},{id:2,name:"Детские праздники",slug:"kids-parties"},{id:3,name:"Свадебные украшения",slug:"wedding"},{id:4,name:"Праздничная посуда",slug:"tableware"}])}})()},[]),(0,r.useEffect)(()=>{if(e.name&&!e.slug){let t=e.name.toLowerCase().replace(/[^a-zа-я0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");s(e=>({...e,slug:t}))}},[e.name,e.slug]);let w=e=>{let{name:t,value:a,type:r}=e.target;s(s=>({...s,[t]:"checkbox"===r?e.target.checked:a}))},_=()=>{y.trim()&&!e.tags.includes(y.trim())&&(s(e=>({...e,tags:[...e.tags,y.trim()]})),j(""))},C=e=>{s(s=>({...s,tags:s.tags.filter(s=>s!==e)}))},S=()=>{let s={};return e.name.trim()||(s.name="Название обязательно"),e.description.trim()||(s.description="Описание обязательно"),(!e.price||0>=parseFloat(e.price))&&(s.price="Укажите корректную цену"),e.category_id||(s.category_id="Выберите категорию"),(!e.stock_quantity||0>parseInt(e.stock_quantity))&&(s.stock_quantity="Укажите количество на складе"),k(s),0===Object.keys(s).length},A=async s=>{if(s.preventDefault(),S()){p(!0);try{let s=localStorage.getItem("admin-token");if(!s)return void v.push("/admin/login");let t=new FormData;Object.entries(e).forEach(e=>{let[s,a]=e;"tags"===s?t.append(s,JSON.stringify(a)):t.append(s,a.toString())}),g&&t.append("image",g);let a=await fetch("/api/admin/products",{method:"POST",headers:{Authorization:"Bearer ".concat(s)},body:t}),r=await a.json();a.ok?(alert("Товар успешно добавлен!"),v.push("/admin_dashboard/products")):alert(r.error||"Ошибка при добавлении товара")}catch(e){alert("Произошла ошибка при добавлении товара")}finally{p(!1)}}};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)(i(),{href:"/admin_dashboard",className:"inline-flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[(0,a.jsx)(c.A,{className:"h-5 w-5 mr-2"}),"Назад к панели управления"]}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Добавить новый товар"})]}),(0,a.jsxs)("form",{onSubmit:A,className:"space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Основная информация"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Название товара *"}),(0,a.jsx)("input",{type:"text",name:"name",value:e.name,onChange:w,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 ".concat(N.name?"border-red-500":"border-gray-300"),placeholder:"Набор воздушных шаров..."}),N.name&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:N.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL slug"}),(0,a.jsx)("input",{type:"text",name:"slug",value:e.slug,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500",placeholder:"nabor-vozdushnyh-sharov"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Краткое описание"}),(0,a.jsx)("input",{type:"text",name:"short_description",value:e.short_description,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500",placeholder:"Краткое описание для превью..."})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Полное описание *"}),(0,a.jsx)("textarea",{name:"description",value:e.description,onChange:w,rows:4,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 ".concat(N.description?"border-red-500":"border-gray-300"),placeholder:"Подробное описание товара..."}),N.description&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:N.description})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Цена и категория"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цена *"}),(0,a.jsx)("input",{type:"number",name:"price",value:e.price,onChange:w,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 ".concat(N.price?"border-red-500":"border-gray-300"),placeholder:"1500",min:"0",step:"0.01"}),N.price&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:N.price})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Старая цена"}),(0,a.jsx)("input",{type:"number",name:"original_price",value:e.original_price,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500",placeholder:"2000",min:"0",step:"0.01"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Категория *"}),(0,a.jsxs)("select",{name:"category_id",value:e.category_id,onChange:w,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 ".concat(N.category_id?"border-red-500":"border-gray-300"),children:[(0,a.jsx)("option",{value:"",children:"Выберите категорию"}),t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]}),N.category_id&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:N.category_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Количество на складе *"}),(0,a.jsx)("input",{type:"number",name:"stock_quantity",value:e.stock_quantity,onChange:w,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 ".concat(N.stock_quantity?"border-red-500":"border-gray-300"),placeholder:"100",min:"0"}),N.stock_quantity&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:N.stock_quantity})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Артикул (SKU)"}),(0,a.jsx)("input",{type:"text",name:"sku",value:e.sku,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500",placeholder:"BAL-001"})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",name:"is_featured",checked:e.is_featured,onChange:w,className:"mr-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Рекомендуемый товар"})]})})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Изображение товара"}),(0,a.jsx)("div",{className:"space-y-4",children:b?(0,a.jsxs)("div",{className:"relative inline-block",children:[(0,a.jsx)(m.default,{src:b,alt:"Preview",width:200,height:200,className:"rounded-lg object-cover"}),(0,a.jsx)("button",{type:"button",onClick:()=>{h(null),f("")},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:(0,a.jsx)(o.A,{className:"h-4 w-4"})})]}):(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,a.jsx)(d.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsxs)("label",{className:"cursor-pointer",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Нажмите для загрузки изображения или перетащите файл сюда"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(t){h(t);let e=new FileReader;e.onloadend=()=>{f(e.result)},e.readAsDataURL(t)}},className:"hidden"})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Теги"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:y,onChange:e=>j(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),_()),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500",placeholder:"Введите тег и нажмите Enter"}),(0,a.jsx)("button",{type:"button",onClick:_,className:"px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600",children:"Добавить"})]}),e.tags.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.tags.map(e=>(0,a.jsxs)("span",{className:"bg-pink-100 text-pink-800 px-3 py-1 rounded-full text-sm flex items-center gap-2",children:[e,(0,a.jsx)("button",{type:"button",onClick:()=>C(e),className:"hover:text-pink-600",children:(0,a.jsx)(o.A,{className:"h-3 w-3"})})]},e))})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"SEO настройки"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meta Title"}),(0,a.jsx)("input",{type:"text",name:"meta_title",value:e.meta_title,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500",placeholder:"Заголовок для поисковиков"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meta Description"}),(0,a.jsx)("textarea",{name:"meta_description",value:e.meta_description,onChange:w,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500",placeholder:"Описание для поисковиков (до 160 символов)"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{type:"submit",disabled:x,className:"bg-pink-500 text-white px-6 py-3 rounded-lg hover:bg-pink-600 focus:outline-none focus:ring-2 focus:ring-pink-500 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Сохранение...":"Сохранить товар"}),(0,a.jsx)(i(),{href:"/admin_dashboard",className:"bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Отмена"})]})]})]})})}},9441:(e,s,t)=>{Promise.resolve().then(t.bind(t,8467))},9869:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[95,6766,8441,1684,7358],()=>s(9441)),_N_E=e.O()}]);